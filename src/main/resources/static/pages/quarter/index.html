<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="./static//images/windows-icon@2x.ico" />

    <title>微兔可视化 | 演示预览</title>

    <!-- 轮播swiper插件样式 -->
    <link rel="stylesheet" href="./static/js/swiper/swiper.min.css" />
    <!-- 翻牌器 -->
    <link rel="stylesheet" href="./static/js/cubeflop/cubeflop.css" />

    <!-- 补间动画包 -->
    <link rel="stylesheet" href="./static/css/custom-animation.css" />

    <!-- 重置样式 -->
    <link rel="stylesheet" href="./static/css/reset.css" />

    <!-- 当前页面样式文件 -->
    <link rel="stylesheet" href="./style.css" />

    <!-- jquery -->
    <script src="./static/js/jquery.min.js"></script>
    <!-- echarts -->
    <script src="./static/js/echarts/echarts.min.js"></script>
    <!-- echarts 水球图 -->
    <script src="./static/js/echarts/echarts-liquidfill.min.js"></script>
    <!-- echarts 词云 -->
    <script src="./static/js/echarts/echarts-wordcloud.min.js"></script>
    <!-- javascript工具库 -->
    <script src="./static/js/lodash.min.js"></script>
    <!-- 二维码插件 -->
    <script src="./static/js/qrcode.min.js"></script>
    <!-- 轮播插件 -->
    <script src="./static/js/swiper/swiper.min.js"></script>
    <!-- 表格滚动插件 -->
    <script src="./static/js/seamscroll.min.js"></script>
    <!-- day 日期插件 -->
    <script src="./static/js/dayjs/dayjs.min.js"></script>
    <script src="./static/js/dayjs/zh-cn.js"></script>
    <!-- 工具类 -->
    <script src="./static/js/utils.js"></script>
    <!-- 滚动数字所需要的插件 -->
    <script src="./static/js/jquery.countTo.js"></script>
    <!-- 翻牌器 -->
    <script src="./static/js/cubeflop/cubeflop.js"></script>
    <!-- d3 -->
    <script src="./static/js/d3.js"></script>

    <!-- 感谢使用微兔可视化，目前处于内测阶段，存在很多的不足开发人员在不断完善中，请谅解~ -->
  </head>

  <body>
    <div class="container">
      <!-- 组件53a2c710-0fd9-11ed-8c3f-7d2eca730bf6开始-->

      <div id="item53a2c710-0fd9-11ed-8c3f-7d2eca730bf6"></div>

      <script type="text/javascript">
        $(function() {
          // 准备dom
          const myChart = echarts.init(document.getElementById("item53a2c710-0fd9-11ed-8c3f-7d2eca730bf6"));
          const init = () => {
          // 指定配置项
            let option = {"grid":{"top":35,"left":15,"right":15,"bottom":15,"containLabel":true},"tooltip":{"show":false,"trigger":"axis","animation":true,"alwaysShowContent":false,"triggerOn":"mousemove","confine":false,"borderColor":"#333","borderWidth":2,"padding":10,"backgroundColor":"rgba(50,50,50,0.7)","axisPointer":{"type":"line","lineStyle":{"color":"#555","width":1,"type":"dashed","cap":"butt","opacity":1},"crossStyle":{"color":"#555","width":1,"type":"dashed","cap":"butt","opacity":1},"shadowStyle":{"color":"rgba(150,150,150,0.3)","opacity":1}},"textStyle":{"color":"#fff","fontWeight":"normal","fontSize":14}},"title":{"text":"                                                                                               --当季均分","show":true,"link":"http://weitu.yunzhisec.com","target":"blank","textStyle":{"color":"rgba(16,225,23,1)","fontStyle":"normal","fontWeight":"bolder","fontSize":30,"lineHeight":30,"textBorderColor":"","textBorderWidth":1,"textBorderType":"solid","textBorderDashOffset":1,"textShadowColor":"transparent","textShadowBlur":1,"textShadowOffsetX":1,"textShadowOffsetY":1,"overflow":"none"},"padding":56,"itemGap":10,"z":10,"left":"center","top":"top","right":"auto","bottom":"auto","backgroundColor":"transparent","borderColor":"","borderWidth":"","borderRadius":1,"shadowBlur":0,"shadowColor":"","shadowOffsetX":"","shadowOffsetY":"","subtext":"","sublink":"","subtarget":"blank","subtextStyle":{"color":"#ffffff","fontStyle":"normal","fontWeight":"normal","fontSize":12,"lineHeight":0,"textBorderColor":"","textBorderWidth":0,"textBorderType":"solid","textBorderDashOffset":0,"textShadowColor":"transparent","textShadowBlur":0,"textShadowOffsetX":0,"textShadowOffsetY":0,"overflow":"none"}},"legend":{"show":true,"top":10,"left":"right","orient":"horizontal","itemWidth":16,"itemHeight":2,"itemGap":10,"icon":"roundRect","textStyle":{"color":"#ffffff","fontSize":12}},"xAxis":{"show":true,"axisLabel":{"show":false,"color":"rgba(241, 248, 255, 0.7)","fontSize":12,"margin":8},"axisLine":{"show":true,"lineStyle":{"color":"#27292d","type":"solid","width":1}},"axisTick":{"show":false,"lineStyle":{"color":"#27292d","type":"solid","width":1}},"splitLine":{"show":true,"lineStyle":{"color":"#27292d","type":"solid","width":1}},"smooth":false,"type":"category","data":["2018冬","2017秋","2018春","2018夏","2018秋","2019冬","2019春","2019夏","2019秋","2020冬","2020春","2020夏","2020秋","2021冬","2021春","2021夏","2021秋","2022冬","2022春","2022夏"]},"yAxis":{"show":true,"axisLabel":{"show":false,"color":"rgba(241, 248, 255, 0.7)","fontSize":12,"margin":8},"axisLine":{"show":false,"lineStyle":{"color":"#27292d","type":"solid","width":1}},"axisTick":{"show":false,"lineStyle":{"color":"#27292d","type":"solid","width":1}},"splitLine":{"show":true,"lineStyle":{"color":"#27292d","type":"dashed","width":1}},"type":"value"},"color":["rgba(16,225,23,1)","#43E8F3"],"series":[]};
            let seriesStyle = {"label":{"show":true,"position":"top","color":"rgba(255, 255, 255, 1)","fontSize":25,"offset":[0,0]},"areaStyle":{"opacity":0,"shadowBlur":6,"shadowColor":"#85a5ff","shadowOffsetX":0,"shadowOffsetY":0},"showSymbol":true,"symbol":"circle","symbolSize":12,"symbolOffset":[0,0],"step":false,"lineStyle":{"opacity":1,"type":"dashed","width":4,"shadowBlur":20,"shadowOffsetX":2,"shadowOffsetY":5},"smooth":true};
            $.ajax({
              url: 'http://43.142.190.8:9001/animeQuarters/selectComQuarterShow',
              type: 'GET',
              data: {},
              headers: {"token":null},
              dataType: "json",
            xhrFields: {  withCredentials: false  },
              success: function(data) {
                // myChart.clear();

                // 数据处理
                let xKey = "bingeWatchingQuarter";
                let yKey = "averageScore";
                let sKey = "name";
                let seriesArr = getArrayValueEnum(data, sKey)
                option.series = []

                // X轴赋值
                let dataColumn = []
                data.forEach(item => dataColumn.push(item[xKey]))
                dataColumn = [...new Set(dataColumn)]
                option.xAxis.data = dataColumn;

                seriesArr.forEach((item, index) => {
                  const datas = data.filter(oitem => oitem[sKey] === item).map(_item => {
                    return {name: _item[xKey], value: _item[yKey]}
                  })
                  option.series.push({
                    name: item,
                    data: datas,
                    type: "line",
                    ...seriesStyle
                  })
                })
                // 使用刚指定的配置项和数据显示图表。
                myChart.setOption(option);
              }
            })
          }
          init();

          setInterval(() => {
            init()
          }, 600000)

        })
      </script>

      <!-- 组件53a2c710-0fd9-11ed-8c3f-7d2eca730bf6结束-->

      <!-- 组件95c75143-7ad4-482d-bc74-70eef1977e3d开始-->

      <div id="item95c75143-7ad4-482d-bc74-70eef1977e3d"></div>

      <script type="text/javascript">
        $(function() {
        // 基于准备好的dom，初始化echarts实例
        const myChart = echarts.init(document.getElementById("item95c75143-7ad4-482d-bc74-70eef1977e3d"));
        // 指定图表的配置项
        const init = ()=>{
          let option = {"grid":{"top":35,"left":0,"right":15,"bottom":15,"containLabel":true},"tooltip":{"show":false,"trigger":"item","animation":true,"alwaysShowContent":false,"triggerOn":"mousemove","confine":false,"borderColor":"#333","borderWidth":2,"padding":10,"backgroundColor":"rgba(50,50,50,0.7)","axisPointer":{"type":"line","lineStyle":{"color":"#555","width":1,"type":"dashed","cap":"butt","opacity":1},"crossStyle":{"color":"#555","width":1,"type":"dashed","cap":"butt","opacity":1},"shadowStyle":{"color":"rgba(150,150,150,0.3)","opacity":1}},"textStyle":{"color":"#fff","fontWeight":"normal","fontSize":14},"formatter":null},"title":{"text":"每季度追番比较图","show":true,"link":"http://weitu.yunzhisec.com","target":"blank","textStyle":{"color":"#fff","fontStyle":"normal","fontWeight":"bold","fontSize":60,"lineHeight":30,"textBorderColor":"","textBorderWidth":1,"textBorderType":"solid","textBorderDashOffset":1,"textShadowColor":"transparent","textShadowBlur":1,"textShadowOffsetX":1,"textShadowOffsetY":1,"overflow":"none"},"padding":50,"itemGap":10,"z":10,"left":"center","top":"auto","right":"auto","bottom":"auto","backgroundColor":"transparent","borderColor":"","borderWidth":"","borderRadius":1,"shadowBlur":0,"shadowColor":"","shadowOffsetX":"","shadowOffsetY":"","subtext":"                                                   --追番总数","sublink":"","subtarget":"blank","subtextStyle":{"color":"rgba(78,195,247,1)","fontStyle":"normal","fontWeight":"bold","fontSize":30,"lineHeight":1,"textBorderColor":"","textBorderWidth":1,"textBorderType":"solid","textBorderDashOffset":1,"textShadowColor":"transparent","textShadowBlur":1,"textShadowOffsetX":1,"textShadowOffsetY":1,"overflow":"none"}},"legend":{"show":false,"top":"top","left":"right","orient":"horizontal","itemWidth":25,"itemHeight":10,"itemGap":10,"icon":"circle","textStyle":{"color":"#ffffff","fontSize":12,"lineHeight":14}},"xAxis":{"show":true,"axisLabel":{"show":true,"color":"rgba(255,255,255,1)","fontSize":25,"margin":20,"height":"14px"},"axisLine":{"show":true,"lineStyle":{"color":"#181919","type":"solid","width":1}},"axisTick":{"show":true,"lineStyle":{"color":"#181919","type":"solid","width":1}},"splitLine":{"show":false,"lineStyle":{"color":"#181919","type":"dashed","width":1}},"data":[]},"yAxis":{"show":false,"name":"单位","nameTextStyle":{"color":"A3A7A9","fontSize":12,"padding":[0,40,0,0]},"axisLabel":{"show":true,"margin":8,"color":"rgba(194, 194, 194, 1)","fontSize":12},"axisLine":{"show":false,"lineStyle":{"color":"#181919","type":"solid","width":1}},"axisTick":{"show":false,"lineStyle":{"color":"#181919","type":"solid","width":1}},"splitLine":{"show":true,"lineStyle":{"color":"#181919","type":"dashed","width":1}}},"color":[{"type":"linear","x":0,"y":0,"x2":0,"y2":1,"colorStops":[{"offset":0,"color":"rgba(255,213,79,1)"},{"offset":0.8270000000000001,"color":"rgba(78,195,247,1)"}],"global":false},"rgba(6,246,240,1)","rgba(102,200,255,1)"],"series":[{"z":2,"type":"pictorialBar","data":[],"symbol":"diamond","symbolOffset":[0,"50%"],"useSeriesStyle":false,"itemStyle":{"normal":{"borderWidth":0}}},{"z":3,"type":"pictorialBar","useSeriesStyle":false,"symbolPosition":"end","data":[],"symbol":"diamond","symbolOffset":[0,"-50%"],"itemStyle":{"normal":{"borderWidth":0}}}]};
          let seriesStyle = {"showBackground":false,"backgroundStyle":{"color":"#0F2024","opacity":1},"itemStyle":{"shadowBlur":0,"shadowColor":"#5c1717","shadowOffsetX":1,"shadowOffsetY":1,"borderRadius":0,"borderColor":"#292929","borderWidth":0,"borderType":"dotted"},"barWidth":24,"label":{"show":true,"position":"right","color":"rgba(33, 14, 129, 1)","fontSize":30,"lineHeight":16},"barGap":"50%"};
          $.ajax(
            {
              url: 'http://43.142.190.8:9001/animeQuarters/selectComQuarterShow',
              type: 'GET',
              data: {},
              headers: {"token":null},
              dataType: "json",
              xhrFields: {  withCredentials: false  },
              success:function(data){
                // myChart.clear()

                //数据处理 开始
                let xKey = "bingeWatchingQuarter"
                let yKey = "bingeWatchingSUM"
                let sKey = "name"
                let seriesArr = []
                let dataColumn = []
                data.forEach(item => seriesArr.push(item[sKey]))
                seriesArr = [...new Set(seriesArr)]
                let complexSeries = [];
                if (xKey && xKey) {
                  data.forEach(item => dataColumn.push(item[xKey]))
                  dataColumn = [...new Set(dataColumn)]
                  function calcOffset(index) {
                    const ofe = 70;
                    const length = seriesArr.length;
                    const startX = -(ofe * (length - 1));
                    const offsetX = startX + ofe * index * 2;
                    return offsetX + "%";
                  }
                  seriesArr.forEach((item, index) => {
                    let arr = [];
                    data.forEach(oitem => {
                      if (oitem[sKey] === item) {
                        arr.push({
                          name: oitem[xKey],
                          value: oitem[yKey]
                        })
                      }
                    })
                    complexSeries.push({
                      name: item,
                      data: arr,
                      type: 'bar'
                    })
                    let copyStyleSeries = deepCopy(option.series);
                    copyStyleSeries[0].data = arr;
                    copyStyleSeries[1].data = arr;


                    copyStyleSeries[0].symbolSize = [
                      seriesStyle.barWidth,
                      seriesStyle.barWidth * 0.5,
                    ];
                    copyStyleSeries[1].symbolSize = [
                      seriesStyle.barWidth,
                      seriesStyle.barWidth * 0.5,
                    ];
                    copyStyleSeries[0].symbolOffset = [calcOffset(index), "50%"];
                    copyStyleSeries[1].symbolOffset = [calcOffset(index), "-50%"];
                    complexSeries.push(...copyStyleSeries);
                  });
                }
                let seriesObj = complexSeries.map((item) => {
                  if (item.useSeriesStyle != false) {
                    return (item = Object.assign(item, seriesStyle));
                  } else {
                    return (item = item);
                  }
                });
                // 数据处理完
                option.yAxis.type = "value";
                option.xAxis.type = "category";
                option.xAxis.data = dataColumn;
                option.series = seriesObj

                myChart.setOption(option);
              }
            }
          );
        }
        init()

          setInterval(()=>{
            init()
          },600000)

        })
      </script>

      <!-- 组件95c75143-7ad4-482d-bc74-70eef1977e3d结束-->
    </div>
  </body>
  <script>






      $(function () {


            /**
             *
             * 自适应宽度处理
             * 通过当前网页具体宽高 / 设计稿画板实际宽高 得到比例最终缩放页面
             *
             * 如果是同比例，比如12:9的尺寸比例，不管分辨率多大，都是能完全适应且不会被拉伸
             * 如果不是在同一比例，简单来就像图片改变了比例就会被拉升
             *
             * 具体大小可自行设置，下面这句话也可以不要，修改style.css样式也可以，方法很多
             *
             */





              document.getElementsByClassName("container")[0].style.transform = `scaleX(${window.innerWidth / 2560}) scaleY(${window.innerHeight / 1440})`





      })























    /**
     *
     * @param {*} id
     * @param {*} animations
     * 执行动画库函数【不用修改,可自行调整位置】
     * 声明初始值
     * 判断动画是否结束
     */
    function playAnimation(id, animations){

      let index = 0
      let ele  = document.querySelector(id)
      setAnimation(ele,animations[index])
      ele.addEventListener('webkitAnimationEnd', function(){
        if(index < animations.length - 1){
          index ++
          setAnimation(ele,animations[index])
        }
      })
    }

    /**
     *
     * @param {*} element
     * @param {*} animation
     * 执行动画库函数【不用修改,可自行调整位置】
     * 取index对应的动画
     * 给元素animation重新赋值
     */
    function setAnimation(element,animation) {
      const action = `${animation.duration * 1000}ms ease ${animation.delayed * 1000}ms ${animation.loop ? "infinite" : animation.frequency} normal both running ${animation.type}`
      element.style.animation = action
    }
  </script>
</html>
